<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>220 Sight Words 小遊戲</title>

<style>
body { margin:0; padding:0; background:#fefaf0; font-family:Arial,sans-serif; display:flex; justify-content:center; align-items:center; flex-direction:column; min-height:100vh;}
.mode-bar { position: sticky; top:0; background:#fefaf0; width:100%; padding:10px 5px; display:flex; flex-wrap:wrap; gap:8px; justify-content:center; z-index:10;}
.mode-bar button { padding:8px 14px; font-size:16px; border-radius:8px; border:2px solid #ccc; background:#fff; cursor:pointer;}
.mode-bar button.active { background:#4CAF50; color:#fff; border-color:#4CAF50;}
.game-container { width:100%; padding:20px; box-sizing:border-box; display:flex; flex-direction:column; gap:20px; align-items:center;}
#gameTitle { margin-bottom:20px; text-align:center; color:#333; line-height:1;}
#questionInfo { margin-bottom:10px; font-size:18px; color:#555;}
.question-card { width:98%; min-height:45vh; background:#fff8dc; border:2px solid #e0c676; border-radius:12px; display:flex; justify-content:center; align-items:center; box-shadow:3px 3px 8px rgba(0,0,0,0.15); overflow:hidden;}
.question-card img { max-width:100%; max-height:100%;}
.options-container { width:100%; display:grid; grid-template-columns:repeat(2,1fr); gap:15px; justify-items:center;}
.card { width:40vw; aspect-ratio:2/1; background:#f0f0f0; border-radius:12px; border:2px solid #ccc; font-weight:bold; display:flex; justify-content:center; align-items:center; cursor:pointer; transition:0.2s;}
.card span { width:100%; text-align:center; white-space:nowrap;}
.card:hover { transform:scale(1.05);}
.correct { background:#d4f8d4 !important;}
.wrong { background:#ffd5d5 !important;}
@media (max-width:480px){.card{width:35vw;}}
</style>
</head>

<body>

<div class="mode-bar">
    <button id="btnAll">All</button>
    <button onclick="setMode(1)">Level 1</button>
    <button onclick="setMode(2)">Level 2</button>
    <button onclick="setMode(3)">Level 3</button>
    <button onclick="setMode(4)">Level 4</button>
    <button onclick="setMode(5)">Level 5</button>
    <button onclick="setMode('order')">照順序練習</button>
</div>

<div class="game-container">
    <h1 id="gameTitle">220 Sight Words 小遊戲</h1>
    <div id="questionInfo"></div>
    <div class="question-card" id="question"></div>
    <div class="options-container" id="options"></div>
</div>

<audio id="correctSound"><source src="https://www.soundjay.com/buttons/sounds/button-3.mp3" type="audio/mpeg"></audio>
<audio id="wrongSound"><source src="https://www.soundjay.com/buttons/sounds/button-10.mp3" type="audio/mpeg"></audio>

<script>
// ================= 完整 220 題庫 =================
// ================= 完整 220 題庫 =================
const questions = [
  // ===== LEVEL 1 001~041 =====
  {img:"220PICTURE/001.jpg", ans:"I", sentence:"I am a boy."},
  {img:"220PICTURE/002.jpg", ans:"I", sentence:"I am a girl."},
  {img:"220PICTURE/003.jpg", ans:"a", sentence:"I see a dog."},
  {img:"220PICTURE/004.jpg", ans:"and", sentence:"I see a dog and a cat."},
  {img:"220PICTURE/005.jpg", ans:"see", sentence:"I see you."},
  {img:"220PICTURE/006.jpg", ans:"big", sentence:"I see a big dog."},
  {img:"220PICTURE/007.jpg", ans:"me", sentence:"Look at me!"},
  {img:"220PICTURE/008.jpg", ans:"my", sentence:"My turtle is green."},
  {img:"220PICTURE/009.jpg", ans:"we", sentence:"We are friends."},
  {img:"220PICTURE/010.jpg", ans:"you", sentence:"You have mail."},
  {img:"220PICTURE/011.jpg", ans:"it", sentence:"Look! It is a bird."},
  {img:"220PICTURE/012.jpg", ans:"down", sentence:"The rain fell down."},
  {img:"220PICTURE/013.jpg", ans:"for", sentence:"Look for the tree."},
  {img:"220PICTURE/014.jpg", ans:"go", sentence:"Let's go to the bus."},
  {img:"220PICTURE/015.jpg", ans:"in", sentence:"Look in the trash."},
  {img:"220PICTURE/016.jpg", ans:"is", sentence:"The carrot is orange."},
  {img:"220PICTURE/017.jpg", ans:"little", sentence:"The lamb is little."},
  {img:"220PICTURE/018.jpg", ans:"one", sentence:"I see one flamingo."},
  {img:"220PICTURE/019.jpg", ans:"the", sentence:"I see the car."},
  {img:"220PICTURE/020.jpg", ans:"to", sentence:"Go to the tree."},
  {img:"220PICTURE/021.jpg", ans:"up", sentence:"The bat went up."},
  {img:"220PICTURE/022.jpg", ans:"away", sentence:"The tire rolled away."},
  {img:"220PICTURE/023.jpg", ans:"blue", sentence:"My jeans are blue."},
  {img:"220PICTURE/024.jpg", ans:"can", sentence:"The butterfly can fly."},
  {img:"220PICTURE/025.jpg", ans:"come", sentence:"Come to the pool."},
  {img:"220PICTURE/026.jpg", ans:"here", sentence:"My lunch is here."},
  {img:"220PICTURE/027.jpg", ans:"not", sentence:"He is not happy."},
  {img:"220PICTURE/028.jpg", ans:"red", sentence:"The crab is red."},
  {img:"220PICTURE/029.jpg", ans:"three", sentence:"I see three mice."},
  {img:"220PICTURE/030.jpg", ans:"two", sentence:"Here are two apples."},
  {img:"220PICTURE/031.jpg", ans:"yellow", sentence:"The banana is yellow."},
  {img:"220PICTURE/032.jpg", ans:"find", sentence:"Can you find the milk?"},
  {img:"220PICTURE/033.jpg", ans:"funny", sentence:"The elephant is funny."},
  {img:"220PICTURE/034.jpg", ans:"help", sentence:"The wagon can help."},
  {img:"220PICTURE/035.jpg", ans:"jump", sentence:"The frog can jump."},
  {img:"220PICTURE/036.jpg", ans:"look", sentence:"Look at the sky."},
  {img:"220PICTURE/037.jpg", ans:"make", sentence:"Clouds make rain."},
  {img:"220PICTURE/038.jpg", ans:"play", sentence:"Let's play basketball."},
  {img:"220PICTURE/039.jpg", ans:"run", sentence:"He can run."},
  {img:"220PICTURE/040.jpg", ans:"said", sentence:"The cow said \"moo\"."},
  {img:"220PICTURE/041.jpg", ans:"where", sentence:"Where are my shoes?"},

  // ===== LEVEL 2 042~093 =====
  {img:"220PICTURE/042.jpg", ans:"all", sentence:"They all play music."},
  {img:"220PICTURE/043.jpg", ans:"at", sentence:"She is at the store."},
  {img:"220PICTURE/044.jpg", ans:"but", sentence:"I like milk but not soy milk."},
  {img:"220PICTURE/045.jpg", ans:"he", sentence:"He plays basketball."},
  {img:"220PICTURE/046.jpg", ans:"on", sentence:"A crown is on the king."},
  {img:"220PICTURE/047.jpg", ans:"she", sentence:"She is sick."},
  {img:"220PICTURE/048.jpg", ans:"that", sentence:"That wall is pink."},
  {img:"220PICTURE/049.jpg", ans:"they", sentence:"They like to sing."},
  {img:"220PICTURE/050.jpg", ans:"was", sentence:"The car was stuck."},
  {img:"220PICTURE/051.jpg", ans:"with", sentence:"Here is a nest with eggs."},
  {img:"220PICTURE/052.jpg", ans:"am", sentence:"I am fishing."},
  {img:"220PICTURE/053.jpg", ans:"be", sentence:"A brick can be heavy."},
  {img:"220PICTURE/054.jpg", ans:"did", sentence:"Did you see the mouse?"},
  {img:"220PICTURE/055.jpg", ans:"do", sentence:"Do you like ice cream?"},
  {img:"220PICTURE/056.jpg", ans:"get", sentence:"He can get the mail."},
  {img:"220PICTURE/057.jpg", ans:"have", sentence:"Birds have wings."},
  {img:"220PICTURE/058.jpg", ans:"out", sentence:"Please take the trash out."},
  {img:"220PICTURE/059.jpg", ans:"so", sentence:"I am tires, so I will rest."},
  {img:"220PICTURE/060.jpg", ans:"there", sentence:"There is a sandbox."},
  {img:"220PICTURE/061.jpg", ans:"what", sentence:"What did the cars do?"},
  {img:"220PICTURE/062.jpg", ans:"are", sentence:"We are brothers."},
  {img:"220PICTURE/063.jpg", ans:"came", sentence:"I came to the beach."},
  {img:"220PICTURE/064.jpg", ans:"like", sentence:"I like flowers."},
  {img:"220PICTURE/065.jpg", ans:"no", sentence:"Say no more!"},
  {img:"220PICTURE/066.jpg", ans:"now", sentence:"Now I will sleep."},
  {img:"220PICTURE/067.jpg", ans:"ride", sentence:"I want to ride a bicycle."},
  {img:"220PICTURE/068.jpg", ans:"this", sentence:"This egg is cracked."},
  {img:"220PICTURE/069.jpg", ans:"went", sentence:"I went on a swing."},
  {img:"220PICTURE/070.jpg", ans:"will", sentence:"I will stop."},
  {img:"220PICTURE/071.jpg", ans:"yes", sentence:"Yes, he won!"},
  {img:"220PICTURE/072.jpg", ans:"brown", sentence:"The briefcase is brown."},
  {img:"220PICTURE/073.jpg", ans:"four", sentence:"I can stack four books."},
  {img:"220PICTURE/074.jpg", ans:"good", sentence:"I feel good."},
  {img:"220PICTURE/075.jpg", ans:"into", sentence:"He drills into the wall."},
  {img:"220PICTURE/076.jpg", ans:"pretty", sentence:"I am pretty mad."},
  {img:"220PICTURE/077.jpg", ans:"ran", sentence:"He ran and fell."},
  {img:"220PICTURE/078.jpg", ans:"saw", sentence:"I saw a ball."},
  {img:"220PICTURE/079.jpg", ans:"too", sentence:"I want to help, too."},
  {img:"220PICTURE/080.jpg", ans:"want", sentence:"I want to jump!"},
  {img:"220PICTURE/081.jpg", ans:"well", sentence:"She does not look well."},
  {img:"220PICTURE/082.jpg", ans:"ate", sentence:"I ate a banana."},
  {img:"220PICTURE/083.jpg", ans:"black", sentence:"The puck is black."},
  {img:"220PICTURE/084.jpg", ans:"eat", sentence:"I will eat a hot dog."},
  {img:"220PICTURE/085.jpg", ans:"must", sentence:"She must flush."},
  {img:"220PICTURE/086.jpg", ans:"new", sentence:"She got new gifts."},
  {img:"220PICTURE/087.jpg", ans:"our", sentence:"This is our house."},
  {img:"220PICTURE/088.jpg", ans:"please", sentence:"Please brush your hair."},
  {img:"220PICTURE/089.jpg", ans:"say", sentence:"A cat can say \"meow\"."},
  {img:"220PICTURE/090.jpg", ans:"soon", sentence:"Soon we will eat a snack."},
  {img:"220PICTURE/091.jpg", ans:"under", sentence:"The ship is under the water."},
  {img:"220PICTURE/092.jpg", ans:"white", sentence:"The swan is white."},
  {img:"220PICTURE/093.jpg", ans:"who", sentence:"Who is on the phone?"},

  // ===== LEVEL 3 094~134 =====
  {img:"220PICTURE/094.jpg", ans:"after", sentence:"After a wish, she blows out the candles."},
  {img:"220PICTURE/095.jpg", ans:"by", sentence:"The ant is by the plant."},
  {img:"220PICTURE/096.jpg", ans:"every", sentence:"Every duck can swim."},
  {img:"220PICTURE/097.jpg", ans:"had", sentence:"The egg had a crack."},
  {img:"220PICTURE/098.jpg", ans:"her", sentence:"Her favorite food is spaghetti."},
  {img:"220PICTURE/099.jpg", ans:"him", sentence:"Let's buy him clothes."},
  {img:"220PICTURE/100.jpg", ans:"his", sentence:"His arm is strong."},
  {img:"220PICTURE/101.jpg", ans:"of", sentence:"He took a bite of his food."},
  {img:"220PICTURE/102.jpg", ans:"old", sentence:"The house was old."},
  {img:"220PICTURE/103.jpg", ans:"take", sentence:"Can you take a picture?"},
  {img:"220PICTURE/104.jpg", ans:"again", sentence:"He winked again."},
  {img:"220PICTURE/105.jpg", ans:"as", sentence:"Run as fast as you can go!"},
  {img:"220PICTURE/106.jpg", ans:"could", sentence:"He could get stung."},
  {img:"220PICTURE/107.jpg", ans:"going", sentence:"She is going to knock."},
  {img:"220PICTURE/108.jpg", ans:"let", sentence:"Let me ring the bell."},
  {img:"220PICTURE/109.jpg", ans:"some", sentence:"Some eyes are blue."},
  {img:"220PICTURE/110.jpg", ans:"then", sentence:"It rained. Then came lightning."},
  {img:"220PICTURE/111.jpg", ans:"think", sentence:"I think the truck is stuck."},
  {img:"220PICTURE/112.jpg", ans:"walk", sentence:"Let's walk around the water."},
  {img:"220PICTURE/113.jpg", ans:"when", sentence:"When do you eat dinner?"},
  {img:"220PICTURE/114.jpg", ans:"an", sentence:"An ice cream cone is yummy!"},
  {img:"220PICTURE/115.jpg", ans:"ask", sentence:"I will ask the teacher."},
  {img:"220PICTURE/116.jpg", ans:"fly", sentence:"He can fly the plane."},
  {img:"220PICTURE/117.jpg", ans:"give", sentence:"Please give the dog his food."},
  {img:"220PICTURE/118.jpg", ans:"may", sentence:"May I paint my nails?"},
  {img:"220PICTURE/119.jpg", ans:"over", sentence:"Let's go over the hill."},
  {img:"220PICTURE/120.jpg", ans:"round", sentence:"The ball is round."},
  {img:"220PICTURE/121.jpg", ans:"stop", sentence:"Her sign says stop."},
  {img:"220PICTURE/122.jpg", ans:"them", sentence:"We take care of them."},
  {img:"220PICTURE/123.jpg", ans:"were", sentence:"There were three blocks."},
  {img:"220PICTURE/124.jpg", ans:"any", sentence:"Do you know any teachers?"},
  {img:"220PICTURE/125.jpg", ans:"from", sentence:"The dolphin is from the ocean."},
  {img:"220PICTURE/126.jpg", ans:"has", sentence:"A fish has gills."},
  {img:"220PICTURE/127.jpg", ans:"how", sentence:"How do you use a drill?"},
  {img:"220PICTURE/128.jpg", ans:"just", sentence:"The baby just crawled."},
  {img:"220PICTURE/129.jpg", ans:"know", sentence:"Do you know what time it is?"},
  {img:"220PICTURE/130.jpg", ans:"live", sentence:"Bats live in caves."},
  {img:"220PICTURE/131.jpg", ans:"once", sentence:"I once had a pet bird."},
  {img:"220PICTURE/132.jpg", ans:"open", sentence:"Let's open the chest."},
  {img:"220PICTURE/133.jpg", ans:"put", sentence:"Put on the vest."},
  {img:"220PICTURE/134.jpg", ans:"thank", sentence:"Thank you for the ring."},

  // ===== LEVEL 4 135~180 =====
  {img:"220PICTURE/135.jpg", ans:"always", sentence:"I always smile."},
  {img:"220PICTURE/136.jpg", ans:"around", sentence:"The sun is around during the day."},
  {img:"220PICTURE/137.jpg", ans:"because", sentence:"I like ice cream because it's sweet."},
  {img:"220PICTURE/138.jpg", ans:"been", sentence:"Have you been to the zoo before?"},
  {img:"220PICTURE/139.jpg", ans:"before", sentence:"I've been to the beach before."},
  {img:"220PICTURE/140.jpg", ans:"best", sentence:"This is the best toy."},
  {img:"220PICTURE/141.jpg", ans:"both", sentence:"We both have red shoes."},
  {img:"220PICTURE/142.jpg", ans:"buy", sentence:"I want to by candy."},
  {img:"220PICTURE/143.jpg", ans:"call", sentence:"I'll call you later."},
  {img:"220PICTURE/144.jpg", ans:"cold", sentence:"It's cold outside."},
  {img:"220PICTURE/145.jpg", ans:"does", sentence:"He does his homework."},
  {img:"220PICTURE/146.jpg", ans:"don't", sentence:"Don't cry."},
  {img:"220PICTURE/147.jpg", ans:"fast", sentence:"The cat is fast."},
  {img:"220PICTURE/148.jpg", ans:"first", sentence:"My first book."},
  {img:"220PICTURE/149.jpg", ans:"five", sentence:"I see five birds."},
  {img:"220PICTURE/150.jpg", ans:"found", sentence:"I found my toy."},
  {img:"220PICTURE/151.jpg", ans:"gave", sentence:"She gove me a gift."},
  {img:"220PICTURE/152.jpg", ans:"goes", sentence:"The bus goes to school."},
  {img:"220PICTURE/153.jpg", ans:"green", sentence:"The leaves are green."},
  {img:"220PICTURE/154.jpg", ans:"its", sentence:"The cat loves its bed."},
  {img:"220PICTURE/155.jpg", ans:"made", sentence:"My mom made cookies."},
  {img:"220PICTURE/156.jpg", ans:"many", sentence:"I have many toys to play with."},
  {img:"220PICTURE/157.jpg", ans:"off", sentence:"Please turn off the lights."},
  {img:"220PICTURE/158.jpg", ans:"or", sentence:"Do you want pizza or pasta?"},
  {img:"220PICTURE/159.jpg", ans:"pull", sentence:"Can you pull the door open?"},
  {img:"220PICTURE/160.jpg", ans:"read", sentence:"I like to read books before bedtime."},
  {img:"220PICTURE/161.jpg", ans:"right", sentence:"You are right!"},
  {img:"220PICTURE/162.jpg", ans:"sing", sentence:"Let's sing a song."},
  {img:"220PICTURE/163.jpg", ans:"sit", sentence:"Please sit down on the chair."},
  {img:"220PICTURE/164.jpg", ans:"time", sentence:"It's time to sleep."},
  {img:"220PICTURE/165.jpg", ans:"story", sentence:"Can you tell me a story?"},
  {img:"220PICTURE/166.jpg", ans:"dog", sentence:"Their dog is cute."},
  {img:"220PICTURE/167.jpg", ans:"delicious", sentence:"These cookies are delicious."},
  {img:"220PICTURE/168.jpg", ans:"colorful", sentence:"Look at those colorful balloons!"},
  {img:"220PICTURE/169.jpg", ans:"once", sentence:"Once upon a time, there was a princess."},
  {img:"220PICTURE/170.jpg", ans:"kids", sentence:"Us kids like to play together."},
  {img:"220PICTURE/171.jpg", ans:"crayons", sentence:"We can use crayons to draw pictures."},
  {img:"220PICTURE/172.jpg", ans:"sunny", sentence:"It's a very sunny day."},
  {img:"220PICTURE/173.jpg", ans:"mom", sentence:"Mon will wash your clothes."},
  {img:"220PICTURE/174.jpg", ans:"which", sentence:"Which book do you want to read?"},
  {img:"220PICTURE/175.jpg", ans:"why", sentence:"Why is the sky blue?"},
  {img:"220PICTURE/176.jpg", ans:"happy", sentence:"I wish you a happy birthday!"},
  {img:"220PICTURE/177.jpg", ans:"dad", sentence:"Dad is going to work now."},
  {img:"220PICTURE/178.jpg", ans:"would", sentence:"I would like some ice cream."},
  {img:"220PICTURE/179.jpg", ans:"write", sentence:"I will write you a letter."},
  {img:"220PICTURE/180.jpg", ans:"your", sentence:"Is this your toy?"},

  // ===== LEVEL 5 181~221 =====
  {img:"220PICTURE/181.jpg", ans:"tell", sentence:"Tell me about your pet."},
  {img:"220PICTURE/182.jpg", ans:"better", sentence:"This cake is better than that one."},
  {img:"220PICTURE/183.jpg", ans:"bring", sentence:"Bring your backpack to school."},
  {img:"220PICTURE/184.jpg", ans:"carry", sentence:"I can carry my bags."},
  {img:"220PICTURE/185.jpg", ans:"need", sentence:"We need to clean our room."},
  {img:"220PICTURE/186.jpg", ans:"safety", sentence:"Use safety scissors to cut paper."},
  {img:"220PICTURE/187.jpg", ans:"done", sentence:"All done with my snack!"},
  {img:"220PICTURE/188.jpg", ans:"draw", sentence:"Let's draw a smiley face."},
  {img:"220PICTURE/189.jpg", ans:"drink", sentence:"I want to drink juice."},
  {img:"220PICTURE/190.jpg", ans:"eight", sentence:"There are eight colorful balloons."},
  {img:"220PICTURE/191.jpg", ans:"fall", sentence:"The leaves fall from the trees."},
  {img:"220PICTURE/192.jpg", ans:"too", sentence:"The park is too far from our house."},
  {img:"220PICTURE/193.jpg", ans:"full", sentence:"My tummy is full after eating dinner."},
  {img:"220PICTURE/194.jpg", ans:"new", sentence:"I got new toys for my birthday."},
  {img:"220PICTURE/195.jpg", ans:"grow", sentence:"Plants grow when you water them."},
  {img:"220PICTURE/196.jpg", ans:"hold", sentence:"Please hold my hand."},
  {img:"220PICTURE/197.jpg", ans:"hot", sentence:"The soup is very hot."},
  {img:"220PICTURE/198.jpg", ans:"hurt", sentence:"Did you hurt yourself when you fell?"},
  {img:"220PICTURE/199.jpg", ans:"umbrella", sentence:"If it rains, we'll need an umbrella."},
  {img:"220PICTURE/200.jpg", ans:"tidy", sentence:"Keep your room tidy."},
  {img:"220PICTURE/201.jpg", ans:"kind", sentence:"Be kind to your friends and share your toys."},
  {img:"220PICTURE/202.jpg", ans:"laugh", sentence:"It's fun to laugh with friends."},
  {img:"220PICTURE/203.jpg", ans:"light", sentence:"Can you turn on the light, please?"},
  {img:"220PICTURE/204.jpg", ans:"long", sentence:"The caterpillar is very long."},
  {img:"220PICTURE/205.jpg", ans:"love", sentence:"I love you so much!"},
  {img:"220PICTURE/206.jpg", ans:"myself", sentence:"I can do it by myself."},
  {img:"220PICTURE/207.jpg", ans:"never", sentence:"I never go to bed without brushing my teeth."},
  {img:"220PICTURE/208.jpg", ans:"only", sentence:"You are my only friend."},
  {img:"220PICTURE/209.jpg", ans:"own", sentence:"I have my own room."},
  {img:"220PICTURE/210.jpg", ans:"pick", sentence:"Let's pick some flowers in the garden."},
  {img:"220PICTURE/211.jpg", ans:"seven", sentence:"There are seven days in a week."},
  {img:"220PICTURE/212.jpg", ans:"shall", sentence:"Shall we go to the park?"},
  {img:"220PICTURE/213.jpg", ans:"show", sentence:"Can you show me your favorite toy?"},
  {img:"220PICTURE/214.jpg", ans:"count", sentence:"I can count to six."},
  {img:"220PICTURE/215.jpg", ans:"small", sentence:"The puppy is small and cute."},
  {img:"220PICTURE/216.jpg", ans:"start", sentence:"Let's start our game now."},
  {img:"220PICTURE/217.jpg", ans:"ten", sentence:"There are ten fingers on my hands."},
  {img:"220PICTURE/218.jpg", ans:"today", sentence:"Today is a sunny day."},
  {img:"220PICTURE/219.jpg", ans:"play", sentence:"Let's play together."},
  {img:"220PICTURE/220.jpg", ans:"try", sentence:"Don't give up, try again!"},
  {img:"220PICTURE/221.jpg", ans:"warm", sentence:"The soup is warm and tasty."}
];

// Level 範圍
const levelRanges={1:[0,41],2:[42,93],3:[94,134],4:[135,180],5:[181,219]};

// ================= 遊戲邏輯 =================
let currentQuestions=[],pool=[],index=0,orderMode=false;
const correctSound=document.getElementById("correctSound");
const wrongSound=document.getElementById("wrongSound");

function fitText(el){let h=el.parentElement.clientHeight*0.8;el.style.fontSize=h+"px";while(el.scrollWidth>el.parentElement.clientWidth&&h>10){h--;el.style.fontSize=h+"px";}}
function shuffle(arr){for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}}

function setMode(mode){
    document.querySelectorAll(".mode-bar button").forEach(b=>b.classList.remove("active"));
    if(mode==="all"){document.getElementById("btnAll").classList.add("active"); currentQuestions=[...questions];shuffle(currentQuestions);}
    else if(mode==="order"){currentQuestions=[...questions];}
    else {const [s,e]=levelRanges[mode];currentQuestions=questions.slice(s,e+1);shuffle(currentQuestions);}
    index=0; pool=questions.map(q=>q.ans);
    loadCurrent();
}

function loadCurrent(){
    if(index>=currentQuestions.length){alert("題目已完成！"); return;}
    const q=currentQuestions[index];
    document.getElementById("questionInfo").innerText=`題目 ${index+1} / ${currentQuestions.length}`;
    const qc=document.getElementById("question");qc.innerHTML="";
    const img=document.createElement("img");img.src=q.img;qc.appendChild(img);

    const opt=document.getElementById("options");opt.innerHTML="";
    let choices=[q.ans];
    while(choices.length<4){let w=pool[Math.floor(Math.random()*pool.length)];if(!choices.includes(w)) choices.push(w);}
    choices.sort(()=>Math.random()-0.5);

    choices.forEach(w=>{
        const card=document.createElement("div");card.className="card";
        const span=document.createElement("span");span.innerText=w;card.appendChild(span);
        setTimeout(()=>fitText(span),0);
        card.onclick=()=>{
            if(w===q.ans){
                card.classList.add("correct");span.innerText="⭕";
                correctSound.currentTime=0;correctSound.play();
                setTimeout(()=>{index++;loadCurrent();},500);
            }else{
                card.classList.add("wrong");span.innerText="❌";
                wrongSound.currentTime=0;wrongSound.play();
            }
        };
        opt.appendChild(card);
    });
}

window.addEventListener("resize",()=>{document.querySelectorAll(".card span").forEach(fitText);});
window.addEventListener("DOMContentLoaded",()=>{setMode("all");});
</script>

</body>
</html>
